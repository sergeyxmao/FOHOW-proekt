<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Интерактивная доска v2.0</title>

  <script src="auth.js"></script>
  <link rel="stylesheet" href="style.css"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

</head>
<body>

  <!-- Левая выезжающая панель -->
  <aside class="sidebar left-sidebar">
    <div class="sidebar-header">
      <h3>Инструменты</h3>
      <button id="left-panel-toggle" class="sidebar-toggle" title="Свернуть панель">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="15 18 9 12 15 6"></polyline></svg>
      </button>
    </div>
    <div class="sidebar-content">
      <div class="tool-group">
        <div class="tool-group-title">История</div>
        <div class="button-row">
          <button id="undo-btn" class="ui-btn" title="Отменить (Ctrl+Z)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 13v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h11.586a1 1 0 0 1 .707.293l2.414 2.414a1 1 0 0 1 0 1.414l-2.414 2.414a1 1 0 0 1-.707.293H10"></path><polyline points="12 10 8 14 12 18"></polyline></svg>
            <span>Отменить</span>
          </button>
          <button id="redo-btn" class="ui-btn" title="Повторить (Ctrl+Shift+Z)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 13v4a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H8.414a1 1 0 0 0-.707.293L5.293 7.707a1 1 0 0 0 0 1.414l2.414 2.414a1 1 0 0 0 .707.293H14"></path><polyline points="12 10 16 14 12 18"></polyline></svg>
            <span>Повторить</span>
          </button>
        </div>
      </div>
      <div class="tool-group">
        <div class="tool-group-title">Файл</div>
        <div class="button-grid">
          <button id="save-project-btn" class="ui-btn" title="Сохранить проект (JSON)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path><polyline points="17 21 17 13 7 13 7 21"></polyline><polyline points="7 3 7 8 15 8"></polyline></svg>
            <span>Сохранить</span>
          </button>
          <button id="load-project-btn" class="ui-btn" title="Загрузить проект из JSON)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path><polyline points="17 8 12 3 7 8"></polyline><line x1="12" y1="3" x2="12" y2="15"></line></svg>
            <span>Загрузить</span>
          </button>
        </div>
      </div>
      <div class="tool-group">
        <div class="tool-group-title">Экспорт</div>
        <div class="button-grid">
          <button id="export-html-btn" class="ui-btn" title="Экспорт в HTML (просмотр)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>
            <span>HTML</span>
          </button>
          <button id="export-svg-btn" class="ui-btn" title="Экспорт в SVG (вектор)">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19l7-7 3 3-7 7-3-3z"></path><path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path><path d="M2 2l7.586 7.586"></path><circle cx="11" cy="11" r="2"></circle></svg>
            <span>SVG</span>
          </button>
          <button id="prepare-print-btn" class="ui-btn" title="Печать / Экспорт в PDF">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 6 2 18 2 18 9"></polyline><path d="M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"></path><rect x="6" y="14" width="12" height="8"></rect></svg>
            <span>Печать</span>
          </button>
        </div>
      </div>
      <div class="tool-group">
        <div class="tool-group-title">Утилиты</div>
        <div class="button-grid">
            <button id="notes-list-btn" class="ui-btn" title="Список заметок" disabled>
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 10.5V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h12.5"></path><path d="M16 2v4"></path><path d="M8 2v4"></path><path d="M3 10h19"></path><path d="M18.5 14.5L21 12l-1.5-1.5"></path><path d="M16 18.5l2.5-2.5-1-1"></path></svg>
              <span>Заметки</span>
            </button>
            <button id="toggle-guides-btn" class="ui-btn" title="Показать/скрыть направляющие">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 3L21 21"></path><path d="M12.5 12.5L11 14l-1.5-1.5"></path><path d="M3 12h1m16 0h1M12 3v1m0 16v1"></path></svg>
              <span>Направляющие</span>
            </button>
             <a id="help-btn" class="ui-btn" title="Открыть инструкцию (DOCX)" href="Описание.docx" download="Инструкция по проекту.docx">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
              <span>Инструкция</span>
            </a>
        </div>
      </div>
      <div class="tool-group add-cards-group">
        <div class="tool-group-title">Добавить лицензию</div>
        <div class="button-row">
          <button id="add-card-btn" class="ui-btn add-btn" title="Добавить стандартную лицензию">
            <span>Стандарт</span>
          </button>
          <button id="add-large-card-btn" class="ui-btn add-btn" title="Добавить большую лицензию">
            <span>Большая</span>
          </button>
        </div>
        <button id="add-template-btn" class="ui-btn add-btn wide" title="Добавить шаблон">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
          <span>Добавить шаблон</span>
        </button>
      </div>
    </div>
  </aside>

  <!-- Правая выезжающая панель -->
  <aside class="sidebar right-sidebar collapsed">
    <div class="sidebar-header">
      <h3>Настройки</h3>
      <button id="right-panel-toggle" class="sidebar-toggle" title="Развернуть настройки">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 18 15 12 9 6"></polyline></svg>
      </button>
    </div>
    <div class="sidebar-content">
      <div class="tool-group">
        <div class="tool-group-title">Режим курсора</div>
        <div class="button-row">
            <button id="selection-mode-btn" class="ui-btn" title="Режим выделения (Esc)">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><path d="M9 3v18"></path></svg>
              <span>Выделение</span>
            </button>
            <button id="hierarchical-drag-mode-btn" class="ui-btn" title="Режим иерархии">
              <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 17v-4.32a2 2 0 0 1 .62-1.44l3-3.6a2 2 0 0 1 2.76 0l3 3.6a2 2 0 0 1 .62 1.44V17"></path><path d="M12 22v-5"></path><path d="M12 7V2"></path><path d="M7 11.5a2.5 2.5 0 0 1 0-5h9a2.5 2.5 0 0 1 0 5h-9z"></path></svg>
              <span>Иерархия</span>
            </button>
        </div>
      </div>
      <div id="line-controls-panel" class="tool-group">
        <div class="tool-group-title">Настройки линии</div>
        <div class="line-color-group">
          <div class="color-picker-wrapper">
            <input type="color" id="hidden-line-color-picker" value="#0f62fe">
            <label for="hidden-line-color-picker" id="line-color-trigger" class="line-color-trigger" title="Выбрать цвет линии"></label>
          </div>
          <button id="apply-all-toggle" class="ui-btn icon-btn" title="Применить ко всем линиям">
            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>
          </button>
        </div>
        <div class="slider-group">
          <label for="thickness-slider">Толщина: <span id="thickness-value">5</span>px</label>
          <input type="range" id="thickness-slider" class="thickness-slider" min="1" max="20" value="5" step="1"/>
        </div>
        <div class="animation-controls">
          <label for="animation-duration-input">Анимация (сек):</label>
          <input type="number" id="animation-duration-input" class="animation-duration-input" min="2" max="999" step="1" value="2" title="Продолжительность анимации в секундах" />
        </div>
      </div>

      <div id="gradient-selector" class="tool-group">
        <div class="tool-group-title">Фон</div>
        <div class="gradient-grid">
          <button class="grad-btn" data-gradient="#f5f7fb" title="Светлый" style="background: #f5f7fb;"></button>
          <button class="grad-btn" data-gradient="linear-gradient(135deg,#eef1f5,#dde3ea)" title="Серый" style="background: linear-gradient(135deg,#eef1f5,#dde3ea);"></button>
          <button id="custom-bg-btn" class="grad-btn" title="Выбрать цвет">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2.69l5.66 5.66a8 8 0 1 1-11.31 0z"></path></svg>
          </button>
          <input type="color" id="custom-bg-input" value="#f5f7fb" style="display:none;">
        </div>
      </div>
    </div>
  </aside>

  <div id="canvas">
    <svg id="svg-layer">
      <defs>
        <marker id="marker-dot" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="6" markerHeight="6">
          <circle cx="5" cy="5" r="4" fill="currentColor"/>
        </marker>
      </defs>
    </svg>
  </div>

  <div id="auth-modal" class="auth-modal" hidden>
    <div class="auth-modal__overlay" aria-hidden="true"></div>
    <div class="auth-modal__dialog" role="dialog" aria-modal="true" aria-labelledby="auth-modal-title" aria-describedby="auth-modal-description">
      <form class="auth-modal__form" data-auth-form>
        <h2 id="auth-modal-title" class="auth-modal__title">Доступ к проекту</h2>
        <p id="auth-modal-description" class="auth-modal__description">
          Введите пароль для продолжения работы с интерактивной доской.
        </p>
        <div class="auth-modal__field">
          <label class="auth-modal__label" for="auth-password-input">Пароль</label>
          <input
            id="auth-password-input"
            class="auth-modal__input"
            type="password"
            name="password"
            autocomplete="current-password"
            inputmode="text"
            required
            minlength="1"
          />
        </div>
        <p class="auth-modal__error" data-auth-error aria-live="assertive" hidden></p>
        <ul class="auth-modal__hints" aria-label="Подсказки по доступу">
          <li>Пароль предоставляется администрацией проекта.</li>
          <li>Нажмите Enter или кнопку «Войти», чтобы подтвердить ввод.</li>
          <li>При возникновении вопросов свяжитесь с <a href="https://t.me/MarketingFohow" target="_blank" rel="noopener noreferrer">@MarketingFohow</a>.</li>
        </ul>
        <button type="submit" class="auth-modal__submit">Войти</button>
      </form>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

  <script src="engine.js"></script>
  <script src="card-features.js"></script> 
  <script src="script.js"></script>
</body>

</html>
